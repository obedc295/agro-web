---
import { getCollection, render } from "astro:content";
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
  const products = await getCollection("products");
  return products.map((product) => ({
    params: { slug: product.slug },
    props: { product }
  }));
}

const { product } = Astro.props;
const { data, slug } = product;
const { nombre, principioActivo, categoria, presentacion, uso, toxicidad, imagen } = data;

const { Content } = await render(product);
export const prerender = true;
---

<Layout title={`${nombre} - AgroWeb`}>
  <div class="flex flex-col md:flex-row mt-10 gap-12">
    <aside class="flex flex-col items-center gap-4 md:w-1/3">
      <a href='/' class="hover:underline opacity-70">← Volver atrás</a>
      <img transition:name={`img-${slug}`} class="rounded w-48 h-64 object-cover" src={imagen} alt={nombre} />

      <div class={`px-3 py-1 rounded text-white font-bold mt-2 ${
        toxicidad === 'Banda roja' ? 'bg-red-600' :
        toxicidad === 'Banda amarilla' ? 'bg-yellow-500' :
        'bg-green-600'
      }`}>
        {toxicidad}
      </div>
    </aside>

    <main class="md:w-2/3">
      <h1 transition:name={`title-${slug}`} class="text-4xl font-bold mb-4">{nombre}</h1>
      <p class="mb-2"><strong>Principio activo:</strong> {principioActivo}</p>
      <p class="mb-2"><strong>Categoría:</strong> {categoria}</p>
      <p class="mb-2"><strong>Uso:</strong> {uso}</p>
      <p class="mb-2"><strong>Presentación:</strong> {presentacion}</p>

      <div class="prose prose-invert mt-4">
        <Content />
      </div>
    </main>
  </div>
</Layout>
